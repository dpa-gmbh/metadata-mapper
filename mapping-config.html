<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-07-23 
 | Rendered using Apache Maven Fluido Skin 1.0.0-SNAPSHOT
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150723" />
    <meta http-equiv="Content-Language" content="en" />
    <title>dpa - metadata mapper &#x2013; Metadata Mapping Configuration</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.0.0-SNAPSHOT.min.css" />
    <link rel="stylesheet" href="./css/dpa-theme-1.0.0-SNAPSHOT.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.0.0-SNAPSHOT.min.js"></script>

                          
        
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css"/>
                      
        
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css"/>
                      
        
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css"/>
                      
        
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
                      
        
<script>hljs.initHighlightingOnLoad();</script>
                      
        
<script src="./js/apache-maven-fluido-1.0.0-SNAPSHOT.min.js" type="text/javascript"></script>
          
    <meta charset="UTF-8" /><!-- [if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"/><![endif] --><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Asciidoctor 1.5.2" />              </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/dpa-gmbh/metadata-mapper">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
            
                                                                                            <img src="images/logos/dpa-logo.svg"  alt="dpa - metadata mapper" width="40%"/>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-07-23
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.2.0
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="introduction.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="build-info.html" title="Build Info">
          <span class="none"></span>
        Build Info</a>
            </li>
                
      <li>
  
                          <a href="usage.html" title="Usage">
          <span class="none"></span>
        Usage</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Mapping</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                  
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            







<div class="section" id="chapter.mappingconfig">
<h2 id="chapter.mappingconfig">Metadata Mapping Configuration</h2>



<p>The mapping configuration is given by an XML file and it&#x2019;s overall structure basically looks like this:</p>




<div>
<pre class="highlight"><tt>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;customized-mapping name=&quot;myMappingOverrides&quot;
  xmlns=&quot;http://xml.dpa.com/cl/metadatamapper/2014-08-08/&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://xml.dpa.com/cl/metadatamapper/2014-08-08/&quot;&gt;
    &lt;config&gt;
      &lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
    &lt;/config&gt;

     &lt;metadata name=&quot;Copyright Notice&quot;&gt;
       &lt;xpath rank=&quot;1&quot; part=&quot;copyright&quot;&gt;&lt;![CDATA[//rightsInfo/copyrightNotice]]&gt;&lt;/xpath&gt;
        &lt;default part=&quot;copyright&quot;&gt;(c) my company&lt;/default&gt;

        &lt;iim&gt;
            &lt;mapsTo part-ref=&quot;copyright&quot;
               dataset=&quot;116&quot;
               field=&quot;CopyrightNotice&quot;
               targetType=&quot;STRING&quot;/&gt;
        &lt;/iim&gt;
        &lt;xmp&gt;
            &lt;mapsTo part-ref=&quot;copyright&quot;
              targetType=&quot;LangAlt&quot;
              targetNamespace=&quot;http://purl.org/dc/elements/1.1/&quot;
              field=&quot;rights&quot;/&gt;
        &lt;/xmp&gt;
    &lt;/metadata&gt;

    &lt;characterMapping id=&quot;utf8-to-iso8859-1&quot;&gt;
        &lt;character from=&quot;0xa6&quot; to=&quot;0x7c&quot; comment=&quot;from &#xa6;; to=|&quot;/&gt;
    &lt;/characterMapping&gt;
&lt;/customized-mapping&gt;</tt></pre></div>




<p>It has a configuration section, a set of mapping definitions and optional character mappings. The root tag
<tt>customized-mapping</tt> indicates that the mapping configuration customizes a (default) mapping. In this
context customization means that it</p>



<ul>

<li>

<p>may add mappings</p>
</li>

<li>

<p>may override existing mappings</p>
</li>

<li>

<p>may change the configuration and character mappings</p>
</li>
</ul>



<p>The default mapping in alignment with the IPTC recommendation (<a href="#IPTC-PhotoMetadata">[IPTC-PhotoMetadata]</a>) is defined
in <a class="externalLink" href="https://github.com/dpa-gmbh/metadata-mapper/blob/master/src/main/resources/image-metadata-mapping/default-mapping.xml">default-mapping.xml</a>.</p>



<p>An example of a customized mapping is given by <a class="externalLink" href="https://github.com/dpa-gmbh/metadata-mapper/blob/master/example/dpa-mapping.xml">dpa Customized Mapping</a>.</p>



<div class="section" id="a_mapping_configurations">
<h3 id="a_mapping_configurations">Mapping Configurations</h3>


<p>The configuration section may look as follows:</p>




<div>
<pre class="highlight"><tt>&lt;config&gt;
  &lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
  &lt;iim charset=&quot;iso8859-1&quot; characterMappingRef=&quot;utf8-to-iso8859-1&quot; defaultReplaceChar=&quot;&#xb7;&quot;/&gt;
  &lt;xmp charset=&quot;utf-8&quot; defaultReplaceChar=&quot;&#xb7;&quot;/&gt;
  &lt;dateParser id=&quot;dateParser-dayOnly&quot; inputDateFormat=&quot;yyyy-MM-dd&quot;/&gt;
  &lt;dateParser id=&quot;dateParser-timestamp&quot; inputDateFormat=&quot;yyyy-MM-dd'T'HH:mm:ssZZZ&quot;/&gt;
&lt;/config&gt;</tt></pre></div>




<div class="section" id="a_timezone">
<h4 id="a_timezone">Timezone</h4>


<p>It specifies the timezone to use for parsing dates which do not contain a timezone specifier. This
timezone is also used as default timezone for the output of dates in case they don&#x2019;t have a timezone specifier.
The timezone format must be compatible with <tt>java.util.TimeZone.getAvailableIDs()</tt>.</p>



</div>
<div class="section" id="sec.characterMapping">
<h4 id="sec.characterMapping">Character Mapping</h4>


<p><tt>&lt;iim&gt;</tt> and <tt>&lt;xmp&gt;</tt> define the character encoding for the related outputs. Please refer to <a href="#sec.characterMapping">Character Mapping</a>.</p>



<p>When generating output based on UTF-8 sources to a limited character encoding (.e.g ISO8859-15)
a mapping for unsupported characters may be required. For this case a character mapping can be declared.</p>


Example of a Character Mapping


<div>
<pre class="highlight"><tt>&lt;characterMapping id=&quot;utf8-to-iso8859-1&quot;&gt;
  &lt;character from=&quot;0xa6&quot; to=&quot;0x7c&quot; comment=&quot;from &#xa6;; to=|&quot;/&gt;
  &lt;character from=&quot;0xa8&quot; to=&quot;0x22&quot; comment=&quot;from &#xa8;; to=&amp;quot;&quot;/&gt;
  &lt;character from=&quot;0xb4&quot; to=&quot;0x27&quot; comment=&quot;from &#xb4;; to='&quot;/&gt;
&lt;/characterMapping&gt;</tt></pre></div>



<table border="0" class="tableblock frame-all grid-all spread"><caption class="title">Table 1. Table Character Mapping</caption>

<colgroup>
<col style="width: 33%;" />
<col style="width: 33%;" />
<col style="width: 33%;" />
</colgroup>
<thead>

<tr class="a">

<th class="tableblock halign-left valign-top">Attribute</th>

<th class="tableblock halign-left valign-top">Usage</th>

<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">from</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">source character unicode value</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">to</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">target character unicode value</p></td>
</tr>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">comment</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">optional</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Human readable expression</p></td>
</tr>
</tbody>
</table>


<p>Such a character mapping has to be configured in the config section of the metadata mapping configuration:</p>




<div>
<pre class="highlight"><tt>&lt;config&gt;
  &lt;iim charset=&quot;iso8859-1&quot; characterMappingRef=&quot;utf8-to-iso8859-1&quot; defaultReplaceChar=&quot;&#xb7;&quot;/&gt;
&lt;/config&gt;</tt></pre></div>




<p>This configuration defines ISO-8859-1 as target encoding for IIM and refers the character mapping to use.
With this configuration the metadata mapper first looks up this table in order to map a character. If a
character could not be found then the mapper checks whether it is a valid character of the target encoding.
If it is not a valid character then the default chacter given by attribute <tt>defaultReplaceChar</tt> is used.</p>



</div>
<div class="section" id="a_date_parser">
<h4 id="a_date_parser">Date Parser</h4>


<p>Date Parser are used to parse input dates using the given <tt>inputDateFormat</tt>. The format string syntax
being used is documented at <a class="bare" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a>.
Mappings may refer Date Parsers in order to parse a date and output this date in a certain date format.</p>




</div></div>
<div class="section" id="a_mapping_metadata">
<h3 id="a_mapping_metadata">Mapping Metadata</h3>


<div class="section" id="a_mapping_name_and_overriding_definitions">
<h4 id="a_mapping_name_and_overriding_definitions">Mapping Name and Overriding Definitions</h4>


<p>A mapping is defined by</p>




<div>
<pre class="highlight"><tt>&lt;metadata name=&quot;Copyright Notice&quot;&gt;</tt></pre></div>




<p>The name of the metadata element is a required attribute. To override a default metadata mapping the name of
this mapping has simply to be reused in the related customized metadata mapping. In the given example the
default metadata mapping for <tt>Copyright Notice</tt> is overriden.</p>



<p>By conventions the name is taken from the <a href="#IPTC-PhotoMetadata">[IPTC-PhotoMetadata]</a> specification.</p>



</div>
<div class="section" id="a_selecting_data">
<h4 id="a_selecting_data">Selecting Data</h4>


<div class="section" id="a_xpath_expressions">
<h5 id="a_xpath_expressions">XPath Expressions</h5>


<p>Each mapping starts with a set of XPath expressions used to select the data out of the source document:</p>




<div>
<pre class="highlight"><tt>&lt;xpath part=&quot;source&quot; rank=&quot;1&quot;&gt;&lt;![CDATA[//rightsInfo/copyrightHolder/name]]&gt;&lt;/xpath&gt;</tt></pre></div>




<p>The XPath expressions have to be compliant to XPath 1.0 and are specified in a CDATA child element.
The <tt>part</tt> of the <tt>xpath</tt> element is the name for the selection. The <tt>rank</tt> attribute allows
the specifiy multiple XPath expressions (alternatives) for a <tt>part</tt>. These alternatives are resolved
in order of their underlying <tt>rank</tt> value.</p>


Example of alternative XPath expressions for copyright holder:


<div>
<pre class="highlight"><tt>&lt;xpath part=&quot;source&quot; rank=&quot;1&quot;&gt;&lt;![CDATA[//rightsInfo/copyrightHolder/name]]&gt;&lt;/xpath&gt;
&lt;xpath part=&quot;source&quot; rank=&quot;2&quot;&gt;&lt;![CDATA[//rightsInfo/copyrightHolder/@literal]]&gt;&lt;/xpath&gt;</tt></pre></div>




<p>By default the implementation of the Metadata Mapper expects <tt>NODE</tt> or <tt>NODELIST</tt> as the result type
for an XPath expression. Result types different from these two have to be declared in the mapping:
An XPath expression returning a string:</p>




<div>
<pre class="highlight"><tt>&lt;xpath part=&quot;language&quot;
       rank=&quot;1&quot;
       returnType=&quot;STRING&quot;&gt;&lt;![CDATA[substring(//contentMeta/language/@tag,1,2)]]&gt;&lt;/xpath&gt;</tt></pre></div>




</div>
<div class="section" id="a_default_values">
<h5 id="a_default_values">Default Values</h5>


<p>Default values function as fallbacks in case the entire set of XPath expressions of a given name does
not match. Defaults can also be used to write a constant value into an image metadata field.</p>


Example of a default value


<div>
<pre class="highlight"><tt>&lt;default part=&quot;copyright&quot;&gt;(c) dpa&lt;/default&gt;</tt></pre></div>




</div>
<div class="section" id="a_processors">
<h5 id="a_processors">Processors</h5>


<p>In some cases a processing of the selected data is appropriate. For these cases a processor
can be used.</p>


Example of a processor declaration


<div>
<pre class="highlight"><tt>&lt;metadata name=&quot;Copyright Notice&quot;&gt;
  &lt;xpath part=&quot;copyright&quot;&gt;&lt;![CDATA[//rightsInfo/copyrightNotice]]&gt;&lt;/xpath&gt;

  &lt;processors&gt;
     &lt;processor
        part-ref=&quot;copyright&quot;
        class=&quot;de.dpa.oss.metadata.mapper.processor.ModifyValueIfNotEmpty&quot;&gt;
        &lt;parameter name=&quot;prependString&quot; value=&quot;(c) &quot;/&gt;
     &lt;/processor&gt;
  &lt;/processors&gt;
  ...
&lt;/metadata&gt;</tt></pre></div>




<p>A Processor refers a part and a class implementing the interface
<tt>de.dpa.oss.metadata.mapper.processor.Processor</tt>.</p>


Processor Interface


<div>
<pre class="highlight"><tt>public interface Processor
{
  /**
   * @param values selected by xpath expression. Empty array if no values have been
   *               selected
   * @return post-processed values
   */
  List&lt;String&gt; process(final List&lt;String&gt; values);
}</tt></pre></div>




<p>The class gets all the values selected by the referred XPath expression and returns the new
list of values.</p>




</div></div>
<div class="section" id="a_definition_of_data_output">
<h4 id="a_definition_of_data_output">Definition of Data Output</h4>


<p>The metadata mapper supports the image metadata standards IPTC Information Interchange Model (IPTC IIM) and
Extensible Metadata Platform (XMP). Regarding XMP it supports the namespaces</p>



<ul>

<li>

<p><a class="bare" href="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/">http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/</a></p>
</li>

<li>

<p><a class="bare" href="http://iptc.org/std/Iptc4xmpExt/2008-02-29/">http://iptc.org/std/Iptc4xmpExt/2008-02-29/</a></p>
</li>

<li>

<p><a class="bare" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></p>
</li>

<li>

<p><a class="bare" href="http://ns.adobe.com/photoshop/1.0/">http://ns.adobe.com/photoshop/1.0/</a></p>
</li>

<li>

<p><a class="bare" href="http://ns.adobe.com/xap/1.0/rights/">http://ns.adobe.com/xap/1.0/rights/</a></p>
</li>

<li>

<p><a class="bare" href="http://ns.useplus.org/ldf/xmp/1.0/">http://ns.useplus.org/ldf/xmp/1.0/</a></p>
</li>
</ul>



<table border="0" class="table table-striped">

<tr class="a">

<td class="icon">
Note
</td>

<td class="content">
This restriction will be lifted soon (see <a class="externalLink" href="https://github.com/dpa-gmbh/metadata-mapper/issues/41">Issue #41</a>)
</td>
</tr>
</table>



<div class="section" id="a_output_of_selected_data_in_general">
<h5 id="a_output_of_selected_data_in_general">Output of Selected Data in General</h5>


<p>A typical metadata mapping may look like follows:</p>




<div>
<pre class="highlight"><tt>&lt;metadata name=&quot;Keywords&quot;&gt;
  &lt;xpath part=&quot;keywords&quot;&gt;&lt;![CDATA[//contentMeta/keyword | //contentMeta/subject/name]]&gt;&lt;/xpath&gt;
  &lt;iim&gt;
    &lt;mapsTo part-ref=&quot;keywords&quot; dataset=&quot;25&quot; field=&quot;Keywords&quot; targetType=&quot;LIST_OF_STRING&quot;/&gt;
  &lt;/iim&gt;
  &lt;xmp&gt;
    &lt;mapsTo field=&quot;subject&quot; targetType=&quot;Bag&quot; targetNamespace=&quot;http://purl.org/dc/elements/1.1/&quot;&gt;
      &lt;mapsTo part-ref=&quot;keywords&quot; field=&quot;subject&quot; targetType=&quot;Text&quot;
              targetNamespace=&quot;http://purl.org/dc/elements/1.1/&quot; /&gt;
    &lt;/mapsTo&gt;
  &lt;/xmp&gt;
&lt;/metadata&gt;</tt></pre></div>




<p>Each output definition is enclosed in a <tt>&lt;iim&gt;</tt> or <tt>&lt;xmp&gt;</tt> tag and consists of a set of <tt>&lt;mapsTo&gt;</tt>
element. Since XMP supports complex, nested data structures, like e. g. sets, structures,
sets of structures and so on, <tt>&lt;mapsTo&gt;</tt> elements can be appropriately nested in the mapping
definition too.</p>



<p>The relation between data selection and data output is implemented by the part name of an
<tt>&lt;xpath&gt;</tt> element: each <tt>&lt;mapsTo&gt;</tt> element refers its' data source via the <tt>part-ref</tt> attribute.
Structure, cardinality and type of the output data field is only determined by the <tt>&lt;mapsTo&gt;</tt> element. The
selected data functions only as source of information. If the selected data contains an array of elements
and the <tt>&lt;mapsTo&gt;</tt> targets a single string then the first element of the array may be output only.</p>



</div>
<div class="section" id="a_mapping_to_iim">
<h5 id="a_mapping_to_iim">Mapping to IIM</h5>


<p>An IIM mapping contains a set of <tt>&lt;mapsTo&gt;</tt> elements. These elements can store a string, a date or
a list of strings. They cannot be nested since IIM des not define structures and the like.</p>



<p>The following attributes are supported for <tt>&lt;mapsTo&gt;</tt> elements:</p>


<table border="0" class="tableblock frame-all grid-all spread"><caption class="title">Table 2. Attributes of IIM &amp;lt;mapsTo&amp;gt; elements</caption>

<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<thead>

<tr class="a">

<th class="tableblock halign-left valign-top">Attribute</th>

<th class="tableblock halign-left valign-top">Type</th>

<th class="tableblock halign-left valign-top">Usage</th>

<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">part-ref</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Refers to a <tt>&lt;xpath&gt;</tt> element</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">field</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Name for IIM field to fill. This name must exactly match one of those Application Record Tags
mentioned at <a class="bare" href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/IPTC.html#ApplicationRecord">http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/IPTC.html#ApplicationRecord</a></p></td>
</tr>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">dataset</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Number</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Dataset number within IIM record 2 (application record)</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">targetType</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Target type: <tt>STRING,LIST_OF_STRING,DATE</tt>.</p></td>
</tr>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">dateParserRef</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Reference</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">optional</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Refers a date input format defined in the configuration section. Example is given below.</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">outputDateFormat</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">optional</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">In case of <tt>targetType=DATE</tt> this attribute specifies the target output format based on a format documented at <a class="bare" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a></p></td>
</tr>
</tbody>
</table>


<p>For addressing the IIM record set, only the field attribut is used. To improve readability of the
mapping declaraction the dataset attribute is mandatory as well.</p>



<p>The <tt>targetType=DATE</tt> is used to generate a date string into a specific format. It requires a <tt>dateParserRef</tt> and
an <tt>outputDateFormat</tt> being set too. <tt>dateParserRef</tt> refers a date parser format given in the config section. This
format is assumed to be given by the input and thus the input string is parsed accordingly. <tt>outputDateFormat</tt>
specifies the output format to use.</p>


Example for Mapping a Date into a certain format


<div>
<pre class="highlight"><tt>&lt;config&gt;
  &lt;dateParser id=&quot;dateParser-dayOnly&quot; inputDateFormat=&quot;yyyy-MM-dd&quot;/&gt;
&lt;/config&gt;
...
&lt;metadata name=&quot;Date Created&quot;&gt;
  &lt;xpath part=&quot;contentCreated&quot;&gt;&lt;![CDATA[//contentMeta/contentCreated]]&gt;&lt;/xpath&gt;
  &lt;iim&gt;
    &lt;mapsTo part-ref=&quot;contentCreated&quot; dataset=&quot;55&quot; field=&quot;DateCreated&quot; targetType=&quot;DATE&quot;
      dateParserRef=&quot;dateParser-dayOnly&quot; outputDateFormat=&quot;yyyy:MM:dd&quot;/&gt;
  &lt;/iim&gt;
&lt;/metadata&gt;</tt></pre></div>




<p>In this example the content selected by <tt>contentCreated</tt> is expected to have the date format <tt>yyyy-MM-dd</tt> and
the metadata field <tt>DateCreated</tt> is filled with a date formatted using <tt>yyyy:MM:dd</tt>.</p>



</div>
<div class="section" id="a_mapping_to_xmp">
<h5 id="a_mapping_to_xmp">Mapping to XMP</h5>


<p>XMP allows the definition of structures and sets (sequences,bags) which can be nested. This may result in
e. g. a structure containing an array of structures containing&#x2026;&#x200b;
In order to define nested structures the <tt>&lt;mapsTo&gt;</tt> elements can be nested in XMP mappings.</p>


Example of nested <tt>&lt;mapsTo&gt;</tt> elements mapping content to an XMP structure


<div>
<pre class="highlight"><tt>&lt;metadata name=&quot;Creator's Contact Info&quot;&gt;
  &lt;xpath part=&quot;line&quot;&gt;&lt;![CDATA[//contentMeta/creator/personDetails/contactInfo/address/line]]&gt;&lt;/xpath&gt;
  &lt;xpath part=&quot;city&quot;&gt;&lt;![CDATA[//contentMeta/creator/personDetails/contactInfo/address/locality/name]]&gt;&lt;/xpath&gt;
  &lt;xmp&gt;
	&lt;mapsTo field=&quot;CreatorContactInfo&quot;
	        targetNamespace=&quot;http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/&quot;
	        targetType=&quot;Struct&quot;&gt;
	  &lt;mapsTo part-ref=&quot;line&quot;
	          field=&quot;CiAdrExtadr&quot;
	          targetNamespace=&quot;http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/&quot;
	          targetType=&quot;Text&quot;/&gt;
	  &lt;mapsTo part-ref=&quot;city&quot;
              field=&quot;CiAdrCity&quot;
              targetNamespace=&quot;http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/&quot;
              targetType=&quot;Text&quot;/&gt;
	&lt;/mapsTo&gt;
  &lt;/xmp&gt;
&lt;/metadata&gt;</tt></pre></div>




<p>The following attributes are supported for <tt>&lt;mapsTo&gt;</tt> elements in XMP mappings:</p>


<table border="0" class="tableblock frame-all grid-all spread"><caption class="title">Table 3. Attributes of XMP &amp;lt;mapsTo&amp;gt; elements</caption>

<colgroup>
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
<col style="width: 25%;" />
</colgroup>
<thead>

<tr class="a">

<th class="tableblock halign-left valign-top">Attribute</th>

<th class="tableblock halign-left valign-top">Type</th>

<th class="tableblock halign-left valign-top">Usage</th>

<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">part-ref</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Refers to a <tt>&lt;xpath&gt;</tt> element</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">targetType</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Possible values: <tt>Text,Integer,Date,LangAlt,Struct,Sequence,Bag</tt></p></td>
</tr>

<tr class="b">

<td class="tableblock halign-left valign-top">
<p class="tableblock">field</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Name of XMP target field</p></td>
</tr>

<tr class="a">

<td class="tableblock halign-left valign-top">
<p class="tableblock">targetNamespace</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">String</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">required</p></td>

<td class="tableblock halign-left valign-top">
<p class="tableblock">Supported namespaces are: <a class="bare" href="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/,http://iptc.org/std/Iptc4xmpExt/2008-02-29/">http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/,http://iptc.org/std/Iptc4xmpExt/2008-02-29/</a>,
<a class="bare" href="http://purl.org/dc/elements/1.1/,http://ns.adobe.com/photoshop/1.0/,http://ns.adobe.com/xap/1.0/rights/,http://ns.useplus.org/ldf/xmp/1.0/">http://purl.org/dc/elements/1.1/,http://ns.adobe.com/photoshop/1.0/,http://ns.adobe.com/xap/1.0/rights/,http://ns.useplus.org/ldf/xmp/1.0/</a></p></td>
</tr>
</tbody>
</table>


<p>In XMP each namespace has a defined set of fields. To find the correct spelling for a field in a
certain namespace please refer to the <a class="bare" href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/XMP.html">http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/XMP.html</a>
where the supported fields (tags) of each namespace is listed.</p>



<div class="section" id="a_limitations_of_xmp_mapping">
<h6 id="a_limitations_of_xmp_mapping">Limitations of XMP Mapping</h6>


<p>In general the metadata mapper supports a small subset of XMP complexity. For instance it does
not support localizations in the form of specifying <tt>xml:lang</tt> attributes for text values.</p>



<p>Due to lack of slice constructs in the configuration language the mapping of sets (sequences,bags)
only a complete array can be bound to a <tt>&lt;mapsTo&gt;</tt> element. It is not possible to iterate over an array
with multiple <tt>&lt;mapsTo&gt;</tt> &quot;calls&quot;. In practical speaking this means:</p>



<ul>

<li>

<p>an array of sclars like a bag of strings can be expressed.</p>
</li>

<li>

<p>structures containing arrays of scalars can be expressed</p>
</li>

<li>

<p>array of structures is not possible to map.</p>
</li>
</ul>






</div></div></div></div>
<div class="section" id="a_reference">
<h3 id="a_reference">Reference</h3>


<ul class="bibliography">

<li>

<p><a name="XMP-part1" id="XMP-part1"></a>[XMP-part1] &quot;XMP SPECIFICATION PART 1&#x2009;&#x2014;&#x2009;DATA MODEL, SERIALIZATION, AND CORE PROPERTIES&quot;, Adobe, <a class="bare" href="http://www.adobe.com/content/dam/Adobe/en/devnet/xmp/pdfs/XMPSpecificationPart1.pdf">http://www.adobe.com/content/dam/Adobe/en/devnet/xmp/pdfs/XMPSpecificationPart1.pdf</a></p>
</li>

<li>

<p><a name="IPTC-PhotoMetadata" id="IPTC-PhotoMetadata"></a>[IPTC-PhotoMetadata] &quot;Photo Metadata&quot;, 2014, IPTC, <a class="bare" href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata">http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata</a></p>
</li>
</ul>







Last updated 2015-07-23 12:19:32 CEST


</div></div>

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                                                          
<div class="row-fluid">Apache Maven, dpa - metadata mapper, Apache, the Apache feather logo, and the Apache Maven project logos are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.</div>
                          </div>

        
                </div>
    </footer>
        </body>
</html>
